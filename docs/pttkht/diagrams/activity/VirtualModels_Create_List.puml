@startuml
skinparam linetype ortho
start
:Đọc cookie token;
if (Hợp lệ?) then (Có)
  if (Hành động?) then (Tạo)
    :Parse JSON/FormData: model info, image;
    :Validate bắt buộc;
    if (Hợp lệ?) then (Có)
      :Upload ảnh lên S3;
      :Prisma: tạo virtual model;
      :200: Trả model mới;
    else (Không)
      :400: Missing/Invalid fields;
    endif
  else (Liệt kê)
    :Prisma: lấy danh sách virtual models theo userId;
    :200: Trả danh sách models;
  endif
  end
else (Không)
  :401: Unauthorized;
  end
endif
@enduml
