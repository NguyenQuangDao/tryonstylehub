@startuml
skinparam linetype ortho
start
:Nhận FormData từ client;
if (Có trường 'file'?) then (Có)
  :Kiểm tra loại MIME và kích thước ≤10MB;
  if (Có tệp hợp lệ?) then (Có)
    :Iterate: xử lý từng tệp;
:Upload lên S3 (thư mục 'products');
:Thu thập URL đã tải lên;
if (Upload S3 thành công?) then (Có)
  if (Đã xử lý hết?) then (Rồi)
    :200: Trả về { urls, success:true };
      stop
  else (Chưa)
    :Iterate: xử lý từng tệp;
  endif
else (Không)
  :500: UPLOAD_FAILED;
  stop
endif
  else (Không)
    :400: IMAGE_INVALID_OR_EMPTY;
    end
  endif
else (Không)
  :400: NO_FILE_UPLOADED;
  end
endif
stop
@enduml
